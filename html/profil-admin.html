<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Profil Admin - Desa Banyusri</title>
  <link rel="stylesheet" href="../style/style-profil-admin.css" />
</head>
<body>

  <header>
    <h1>Profil Admin Desa Banyusri</h1>
    <nav>
      <a href="dashboard-admin.html">Dashboard</a>
      <a href="profil-admin.html">Profil Desa</a>
      <a href="pengaduan-admin.html">Lihat Pengaduan</a>
      <a href="layanan-admin.html">Kelola Layanan</a>
      <a href="pengumuman-admin.html">Kelola Pengumuman</a>
      <a href="warga-admin.html">Data Warga</a>
      <a href="login.html">Keluar</a>
    </nav>
  </header>

  <main>
    <h2>1. Data Umum Desa</h2>
    <input type="text" id="nama-desa" />
    <input type="text" id="kecamatan" />
    <button onclick="updateProfil()">Simpan Perubahan</button>

    <p><strong>Kabupaten:</strong> Boyolali</p>
    <p><strong>Provinsi:</strong> Jawa Tengah</p>
    <p><strong>Kode Pos:</strong> 57382</p>

    <h2>2. Sejarah Singkat</h2>
    <p>
      Desa Banyusri merupakan salah satu desa di Kecamatan Wonosegoro, Kabupaten Boyolali.
      Nama "Banyusri" berasal dari kata "Banyu" (air) dan "Sri" (kemakmuran), mencerminkan
      harapan masyarakat akan kesejahteraan dari kekayaan air yang melimpah.
    </p>

    <h2>3. Visi dan Misi</h2>
    <p><strong>Visi:</strong> Mewujudkan Desa Banyusri yang mandiri, maju, dan sejahtera.</p>
    <p><strong>Misi:</strong></p>
    <ul>
      <li>Memberikan pelayanan publik yang cepat dan transparan.</li>
      <li>Mendorong partisipasi masyarakat dalam pembangunan.</li>
      <li>Memanfaatkan potensi lokal untuk meningkatkan ekonomi desa.</li>
      <li>Melestarikan lingkungan dan budaya lokal.</li>
    </ul>

    <h2>4. Struktur Pemerintahan Desa</h2>
    <ul>
      <li>Kepala Desa: Bpk. Sukardi</li>
      <li>Sekretaris Desa</li>
      <li>Kaur Pemerintahan</li>
      <li>Kaur Keuangan</li>
      <li>Kaur Umum</li>
      <li>Kepala Dusun 1, 2, dan 3</li>
    </ul>

    <h2>5. Kontak Admin</h2>
    <p><strong>Alamat Kantor:</strong> Jl. Raya Banyusri No.1, Wonosegoro, Boyolali</p>
    <p><strong>Email Admin:</strong> admin@banyusri.desa.id</p>
    <p><strong>Telepon:</strong> (0276) 123456</p>
  </main>

  <footer>
    &copy; 2025 Desa Banyusri - KKN Kelompok 22 Periode 7
  </footer>

  <!-- Tambahkan ini sebelum </body> -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <script src="../firebase-config.js"></script>
  <script>
    auth.onAuthStateChanged((user) => {
      if (user) {
        db.collection("users").doc(user.uid).get().then(doc => {
          const data = doc.data();
          if (!data || data.role !== "admin") {
            alert("Akses ditolak. Anda bukan admin.");
            window.location.href = "../login.html";
          }
        });
      } else {
        alert("Silakan login terlebih dahulu.");
        window.location.href = "../login.html";
      }
    });
  </script>
  <script>
  const db = firebase.firestore();

  function loadProfil() {
    db.collection("profil").doc("desaBanyusri").get()
      .then(doc => {
        if (doc.exists) {
          const data = doc.data();
          document.getElementById("nama-desa").value = data.namaDesa;
          document.getElementById("kecamatan").value = data.kecamatan;
          // lanjutkan sesuai lainnya
        }
      })
      .catch(err => console.error("Gagal memuat profil: ", err));
  }

  function updateProfil() {
    const updatedData = {
      namaDesa: document.getElementById("nama-desa").value,
      kecamatan: document.getElementById("kecamatan").value,
      // lanjutkan sesuai lainnya
    };

    db.collection("profil").doc("desaBanyusri").update(updatedData)
      .then(() => alert("Profil berhasil diperbarui!"))
      .catch(err => alert("Gagal update: " + err.message));
  }

  loadProfil();
</script>

</body>
</html>
